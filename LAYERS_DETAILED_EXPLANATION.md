# ุดุฑุญ ุชูุตููู ูุทุจูุงุช ูุธุงู ูุดู ุงูุงุญุชูุงู

## ๐ **ูุธุฑุฉ ุนุงูุฉ**

ุงููุธุงู ูุชููู ูู **4 ุทุจูุงุช ูุชูุงููุฉ** ุชุนูู ูุนุงู ูุชูููู ูุฎุงุทุฑ ูู ูุนุงููุฉ:

1. **Behavioral Risk (ูุฎุงุทุฑ ุงูุณููู)** - 0-50 ููุทุฉ
2. **AI/ML Risk (ููุงุฐุฌ ุงูุฐูุงุก ุงูุงุตุทูุงุนู)** - 0-40 ููุทุฉ
3. **Sequence Risk (ุชุญููู ุชุณูุณู ุงูุฌูุณุฉ)** - 0-30 ููุทุฉ
4. **Graph Risk (ุงูุฑุณู ุงูุดุจูู ูุงูุงุฑุชุจุงุทุงุช)** - 0-50 ููุทุฉ

**ุงููุฌููุน ุงูููู**: 0-100 ููุทุฉ (ูุญุฏูุฏ)

---

# ๐ต **ุงูุทุจูุฉ 1: Behavioral Risk (ูุฎุงุทุฑ ุงูุณููู ูุงูุงุณุชุฎุฏุงู)**

## **1.1 ููุงุฐุง ูุฐู ุงูุทุจูุฉุ**

### **ุงูุณุจุจ ุงูุฃุณุงุณู:**
- **ุฃูู ุฎุท ุฏูุงุน**: ุชุญููู ุงูุณููู ุงูููุฑู ูุจู ุฃู ูุนุงูุฌุฉ ูุนูุฏุฉ
- **ููุงุนุฏ ูุงุถุญุฉ**: ูููู ุชูุณูุฑูุง ุจุณูููุฉ ูููุณุชุฎุฏููู ูุงููุณุคูููู
- **ุณุฑุนุฉ**: ูุง ุชุญุชุงุฌ ููุงุฐุฌ MLุ ููุท ููุงุนุฏ ููุทููุฉ
- **ูุนุงููุฉ**: ูุนุธู ูุญุงููุงุช ุงูุงุญุชูุงู ุชุธูุฑ ุฃููุงุท ุณููููุฉ ุบูุฑ ุนุงุฏูุฉ

### **ูุง ุงูุฐู ุชูุชุดูู:**
- ุฌูุงุฒ ุฌุฏูุฏ ูู ููุณุชุฎุฏู ูู ูุจู
- ููุฒุฉ ุฌุบุฑุงููุฉ ูุจูุฑุฉ (ุณูุฑ ููุงุฌุฆ)
- ููุช ุบูุฑ ูุนุชุงุฏ (2-5 ุตุจุงุญุงู)
- ุถุบุท ุนูููุงุช ุนุงูู (ุฃูุซุฑ ูู 8 ุนูููุงุช ูู 24 ุณุงุนุฉ)
- ุทูุจ ุฎุฏูุฉ ุญุณุงุณุฉ

---

## **1.2 ููู ุชุนูู ุงูุญุณุงุจุงุชุ**

### **ุงูุฎุทูุงุช:**

#### **ุงูุฎุทูุฉ 1: ุชุญุฏูุฏ ุงูุฅุดุงุฑุงุช ุงูุญูุฑุงุก**
```python
device_is_new = not req["device_is_known"]           # True/False
location_jump = req["location_change_km"] > 500       # True/False
unusual_time = req["hour_of_day"] in [2, 3, 4, 5]      # True/False
high_frequency = req["ops_last_24h"] > 8              # True/False
is_sensitive = req["is_sensitive_service"]            # True/False

# ูุญุณุจ ุนุฏุฏ ุงูุฅุดุงุฑุงุช ุงูุญูุฑุงุก ููุณูุงู
red_flags = sum([
    device_is_new,
    location_jump,
    unusual_time,
    high_frequency,
    is_sensitive
])
```

**ููุงุฐุง ูุญุณุจ `red_flags`ุ**
- ูุชุญุฏูุฏ **ุงูุณูุงู**: ููุณ ุงูุฅุดุงุฑุฉ ููุง ูุฒู ูุฎุชูู ุญุณุจ ูุฌูุฏ ุฅุดุงุฑุงุช ุฃุฎุฑู
- ูุซุงู: ุฌูุงุฒ ุฌุฏูุฏ + ุฎุฏูุฉ ุญุณุงุณุฉ = ูุฑูุจ ุฃูุซุฑ ูู ุฌูุงุฒ ุฌุฏูุฏ ููุท

---

#### **ุงูุฎุทูุฉ 2: ุญุณุงุจ ุงูููุงุท ููู ุฅุดุงุฑุฉ**

##### **ุฃ) ุฌูุงุฒ ุฌุฏูุฏ (New Device)**
```python
if device_is_new:
    if red_flags >= 3:        # 3+ ุฅุดุงุฑุงุช ุญูุฑุงุก ุฃุฎุฑู
        risk += 20            # ูุฒู ุนุงูู
    elif is_sensitive:        # ุฌูุงุฒ ุฌุฏูุฏ + ุฎุฏูุฉ ุญุณุงุณุฉ
        risk += 18            # ูุฒู ูุชูุณุท-ุนุงูู
    else:                     # ุฌูุงุฒ ุฌุฏูุฏ ููุท
        risk += 12            # ูุฒู ูุชูุณุท
```

**ุงูููุทู:**
- **12 ููุทุฉ**: ุฌูุงุฒ ุฌุฏูุฏ ููุท (ูุฏ ูููู ุดุฑุงุก ุฌูุงุฒ ุฌุฏูุฏ)
- **18 ููุทุฉ**: ุฌูุงุฒ ุฌุฏูุฏ + ุฎุฏูุฉ ุญุณุงุณุฉ (ูุฑูุจ)
- **20 ููุทุฉ**: ุฌูุงุฒ ุฌุฏูุฏ + 3+ ุฅุดุงุฑุงุช ุฃุฎุฑู (ูุฑูุจ ุฌุฏุงู)

**ูุซุงู:**
- ุฌูุงุฒ ุฌุฏูุฏ + ูู ุดูุก ุทุจูุนู = **12 ููุทุฉ**
- ุฌูุงุฒ ุฌุฏูุฏ + ุฎุฏูุฉ ุญุณุงุณุฉ = **18 ููุทุฉ**
- ุฌูุงุฒ ุฌุฏูุฏ + ููุฒุฉ ูููุน + ููุช ุบูุฑ ูุนุชุงุฏ + ุฎุฏูุฉ ุญุณุงุณุฉ = **20 ููุทุฉ**

---

##### **ุจ) ููุฒุฉ ูููุน ูุจูุฑุฉ (Location Jump)**
```python
if location_jump:  # > 500 km
    if device_is_new and is_sensitive:
        risk += 20  # ุฃุณูุฃ ุณููุงุฑูู
    elif device_is_new or is_sensitive:
        risk += 12  # ุญุงูุฉ ูุชูุณุทุฉ
    else:
        risk += 8   # ููุฒุฉ ูููุน ููุท (ูุฏ ูููู ุณูุฑ ุดุฑุนู)
```

**ุงูููุทู:**
- **8 ููุงุท**: ููุฒุฉ ูููุน ููุท (ูุฏ ูููู ุณูุฑ)
- **12 ููุทุฉ**: ููุฒุฉ ูููุน + ุฌูุงุฒ ุฌุฏูุฏ **ุฃู** ุฎุฏูุฉ ุญุณุงุณุฉ
- **20 ููุทุฉ**: ููุฒุฉ ูููุน + ุฌูุงุฒ ุฌุฏูุฏ + ุฎุฏูุฉ ุญุณุงุณุฉ (ุฃุณูุฃ ุณููุงุฑูู)

**ูุซุงู:**
- ููุฒุฉ ูููุน 600 ูู + ุฌูุงุฒ ูุนุฑูู + ุฎุฏูุฉ ุนุงุฏูุฉ = **8 ููุงุท**
- ููุฒุฉ ูููุน 600 ูู + ุฌูุงุฒ ุฌุฏูุฏ = **12 ููุทุฉ**
- ููุฒุฉ ูููุน 600 ูู + ุฌูุงุฒ ุฌุฏูุฏ + ุชุฌุฏูุฏ ูููุฉ = **20 ููุทุฉ**

---

##### **ุฌ) ููุช ุบูุฑ ูุนุชุงุฏ (Unusual Time)**
```python
if unusual_time:  # 2-5 ุตุจุงุญุงู
    if device_is_new:
        risk += 12  # ููุช ุบูุฑ ูุนุชุงุฏ + ุฌูุงุฒ ุฌุฏูุฏ = ูุฑูุจ
    else:
        risk += 8   # ููุช ุบูุฑ ูุนุชุงุฏ ููุท (ูุฏ ูููู ุนูู ููู)
```

**ุงูููุทู:**
- **8 ููุงุท**: ููุช ุบูุฑ ูุนุชุงุฏ ููุท (ูุฏ ูููู ุนูู ููู)
- **12 ููุทุฉ**: ููุช ุบูุฑ ูุนุชุงุฏ + ุฌูุงุฒ ุฌุฏูุฏ (ูุฑูุจ)

---

##### **ุฏ) ุถุบุท ุนูููุงุช ุนุงูู (High Frequency)**
```python
if high_frequency:  # > 8 ุนูููุงุช ูู 24 ุณุงุนุฉ
    if req["ops_last_24h"] > 15:  # ุนุชุจุฉ ุนุงููุฉ ุฌุฏุงู
        risk += 15
    else:
        risk += 8
```

**ุงูููุทู:**
- **8 ููุงุท**: 9-15 ุนูููุฉ (ุถุบุท ูุชูุณุท)
- **15 ููุทุฉ**: 16+ ุนูููุฉ (ุถุบุท ุนุงูู ุฌุฏุงู)

---

##### **ูู) ุฎุฏูุฉ ุญุณุงุณุฉ (Sensitive Service)**
```python
if is_sensitive:
    if red_flags >= 4:              # 4+ ุฅุดุงุฑุงุช ุญูุฑุงุก
        risk += 18
    elif red_flags >= 3:            # 3 ุฅุดุงุฑุงุช ุญูุฑุงุก
        risk += 12
    elif device_is_new or location_jump:
        risk += 10                  # ุฎุฏูุฉ ุญุณุงุณุฉ + ุฌูุงุฒ ุฌุฏูุฏ ุฃู ููุฒุฉ ูููุน
    else:
        risk += 8                   # ุฎุฏูุฉ ุญุณุงุณุฉ ููุท
```

**ุงูููุทู:**
- **8 ููุงุท**: ุฎุฏูุฉ ุญุณุงุณุฉ ููุท (ุทุจูุนู - ุงููุณุชุฎุฏู ูุฏ ูุญุชุงุฌูุง)
- **10 ููุงุท**: ุฎุฏูุฉ ุญุณุงุณุฉ + ุฌูุงุฒ ุฌุฏูุฏ **ุฃู** ููุฒุฉ ูููุน
- **12 ููุทุฉ**: ุฎุฏูุฉ ุญุณุงุณุฉ + 3 ุฅุดุงุฑุงุช ุญูุฑุงุก
- **18 ููุทุฉ**: ุฎุฏูุฉ ุญุณุงุณุฉ + 4+ ุฅุดุงุฑุงุช ุญูุฑุงุก

---

#### **ุงูุฎุทูุฉ 3: ุชุญุฏูุฏ ุงูุณูู**
```python
return min(risk, 50), reasons  # ุณูู 50 ููุทุฉ
```

**ููุงุฐุง ุงูุณูู 50ุ**
- ูุชูุงุฒู ุฃูุถู ูุน ุงูุทุจูุงุช ุงูุฃุฎุฑู
- ููุน ููููุฉ ุทุจูุฉ ูุงุญุฏุฉ ุนูู ุงููุชูุฌุฉ ุงููููุฉ
- ูุน 4 ุทุจูุงุชุ ูู ุทุจูุฉ ุชุณุงูู ุจูุณุจุฉ ูุนูููุฉ

---

## **1.3 ูุซุงู ุนููู**

### **ุณููุงุฑูู:**
- ุฌูุงุฒ ุฌุฏูุฏ: โ
- ููุฒุฉ ูููุน: 800 ูู โ
- ููุช ุบูุฑ ูุนุชุงุฏ: 3 ุตุจุงุญุงู โ
- ุถุบุท ุนูููุงุช: 12 ุนูููุฉ โ
- ุฎุฏูุฉ ุญุณุงุณุฉ: ุชุฌุฏูุฏ ูููุฉ โ

### **ุงูุญุณุงุจ:**
```python
red_flags = 5  # ูู ุงูุฅุดุงุฑุงุช ููุฌูุฏุฉ

# ุฌูุงุฒ ุฌุฏูุฏ
if red_flags >= 3: risk += 20  # โ

# ููุฒุฉ ูููุน
if device_is_new and is_sensitive: risk += 20  # โ

# ููุช ุบูุฑ ูุนุชุงุฏ
if device_is_new: risk += 12  # โ

# ุถุบุท ุนูููุงุช
if ops_last_24h > 15: risk += 15  # โ (12 < 15)
else: risk += 8  # โ

# ุฎุฏูุฉ ุญุณุงุณุฉ
if red_flags >= 4: risk += 18  # โ

# ุงููุฌููุน
total = 20 + 20 + 12 + 8 + 18 = 78
# ุงูุณูู
final = min(78, 50) = 50 ููุทุฉ โ
```

---

## **1.4 ููุงุท ุงูููุฉ**

โ **ุณูุงูู (Context-Aware)**: ููุณ ุงูุฅุดุงุฑุฉ ููุง ูุฒู ูุฎุชูู ุญุณุจ ุงูุณูุงู
โ **ูุชูุงุฒู**: ูุง ููุฑุท ูู ุงูุญุธุฑ ููุง ูู ุงูุณูุงุญ
โ **ุณุฑูุน**: ูุง ูุญุชุงุฌ ููุงุฐุฌ ML
โ **ูุงุจู ููุชูุณูุฑ**: ูู ููุทุฉ ููุง ุณุจุจ ูุงุถุญ

---

# ๐ข **ุงูุทุจูุฉ 2: AI/ML Risk (ููุงุฐุฌ ุงูุฐูุงุก ุงูุงุตุทูุงุนู)**

## **2.1 ููุงุฐุง ูุฐู ุงูุทุจูุฉุ**

### **ุงูุณุจุจ ุงูุฃุณุงุณู:**
- **ุงูุชุดุงู ุฃููุงุท ูุนูุฏุฉ**: ML ููููู ุงูุชุดุงู ุนูุงูุงุช ุบูุฑ ูุงุถุญุฉ ููููุงุนุฏ
- **ุชุนูู ูู ุงูุจูุงูุงุช**: ูุชุนูู ูู 4000 ุนููุฉ ุชุฏุฑูุจ
- **3 ููุงุฐุฌ ููููุฉ**: ูู ูููุฐุฌ ูู ููุงุท ููุฉ ูุฎุชููุฉ
- **ุฏูุฉ ุนุงููุฉ**: RandomForest 98.88%ุ Neural Network 96.25%

### **ูุง ุงูุฐู ุชูุชุดูู:**
- ุฃููุงุท ุบูุฑ ูุฑุฆูุฉ ููููุงุนุฏ
- ุนูุงูุงุช ูุนูุฏุฉ ุจูู 8 ุฎุตุงุฆุต
- ุดุฐูุฐ ูู ุงูุจูุงูุงุช (IsolationForest)
- ุงุญุชูุงูุงุช ุฅุญุตุงุฆูุฉ (RandomForest, Neural Network)

---

## **2.2 ููู ุชุนูู ุงูุญุณุงุจุงุชุ**

### **ุงูุฎุทูุงุช:**

#### **ุงูุฎุทูุฉ 1: ุงุณุชุฎุฑุงุฌ ุงูุฎุตุงุฆุต (Feature Extraction)**

ุงููุธุงู ูุญูู ุงูุจูุงูุงุช ุงูุฎุงู ุฅูู **8 ุฎุตุงุฆุต ุฑูููุฉ**:

```python
# ูู ุงูุจูุงูุงุช ุงูุฎุงู
device_is_known = True/False
location_change_km = 800.0
hour_of_day = 3
ops_last_24h = 12
is_sensitive_service = True
session_sequence = ["login", "renew_id", "upload_doc", "logout"]

# ุฅูู ุฎุตุงุฆุต ุฑูููุฉ
session_length = len(session_sequence)  # 4
sensitive_count = sum(1 for a in seq if a in SENSITIVE_ACTIONS)  # 1
repeated_flag = 1 if (seq.count("login") >= 3 or seq.count("payment") >= 2) else 0  # 0

# Feature Vector (8 ุฃุจุนุงุฏ)
x = [
    int(device_is_known),      # 0 ุฃู 1
    float(location_change_km), # 800.0
    float(hour_of_day),        # 3.0
    float(ops_last_24h),       # 12.0
    int(is_sensitive_service), # 1
    float(session_length),     # 4.0
    float(sensitive_count),    # 1.0
    float(repeated_flag)       # 0.0
]
```

**ููุงุฐุง 8 ุฎุตุงุฆุตุ**
- **5 ุฎุตุงุฆุต ุณููููุฉ**: device, location, time, frequency, sensitivity
- **3 ุฎุตุงุฆุต ูู ุงูุฌูุณุฉ**: length, sensitive_count, repeated_flag
- **ูุชูุงุฒูุฉ**: ูุง ููููุฉ (ููุต ูุนูููุงุช) ููุง ูุซูุฑุฉ (overfitting)

---

#### **ุงูุฎุทูุฉ 2: ุชุทุจูู ุงูููุงุฐุฌ ุงูุซูุงุซุฉ**

##### **ุฃ) RandomForest (ุฅุดุฑุงูู - Supervised)**

```python
# ุงููููุฐุฌ ุชุฏุฑูุจ ุนูู 3,200 ุนููุฉ (80% ูู 4,000)
# ุฏูุฉ: 98.88%

proba_risky = rf_model.predict_proba(x)[0][1]  # ุงุญุชูุงู ุงููุฎุงุทุฑุฉ (0-1)
rf_risk = int(proba_risky * 25)  # ุชุญููู ุฅูู 0-25 ููุทุฉ

# ูุซุงู:
# proba_risky = 0.95 โ rf_risk = int(0.95 * 25) = 23 ููุทุฉ
```

**ููู ูุนูู RandomForestุ**
- **ุดุฌุฑุฉ ูุฑุงุฑุงุช ูุชุนุฏุฏุฉ**: ูุจูู 150 ุดุฌุฑุฉ ูุฑุงุฑ
- **ุชุตููุช**: ูู ุดุฌุฑุฉ ุชุตููุชุ ุงููุชูุฌุฉ = ุงูุฃุบูุจูุฉ
- **ุงุญุชูุงู**: `predict_proba` ูุนุทู ุงุญุชูุงู (0-1)
- **ูุซุงู**: ุฅุฐุง 95% ูู ุงูุฃุดุฌุงุฑ ุชููู "risky"ุ `proba_risky = 0.95`

**ููุงุฐุง 25 ููุทุฉ ูุญุฏ ุฃูุตูุ**
- ูุน 3 ููุงุฐุฌุ ูู ูููุฐุฌ ูุณุงูู ุจู 0-25 ููุทุฉ
- ุงููุฌููุน: 0-75 ููุทุฉ โ ูุญุฏูุฏ ุจู 40 ููุทุฉ (ููุน ุงูุชุถุฎู)

---

##### **ุจ) IsolationForest (ุบูุฑ ุฅุดุฑุงูู - Unsupervised Anomaly Detection)**

```python
# ุงููููุฐุฌ ุชุฏุฑูุจ ุนูู 3,200 ุนููุฉ (ุจุฏูู labels)
# ููุชุดู ุงูุดุฐูุฐ ุจูุงุกู ุนูู ุงูุนุฒูุฉ (isolation)

iso_pred = iso_model.predict(x)[0]        # -1 = anomaly, 1 = normal
iso_score = iso_model.decision_function(x)[0]  # ุฏุฑุฌุฉ ุงูุดุฐูุฐ (-0.5 ุฅูู 0.5)

iso_risk = 0
if iso_pred == -1:  # ุงูุชุดู ุดุฐูุฐ
    iso_risk = min(int(abs(iso_score) * 80), 25)  # 0-25 ููุทุฉ
```

**ููู ูุนูู IsolationForestุ**
- **ูุจุฏุฃ ุงูุนุฒูุฉ**: ุงูุจูุงูุงุช ุงูุดุงุฐุฉ ุฃุณูู ูู ุนุฒูุชูุง
- **ุดุฌุฑุฉ ุนุฒู**: ูุจูู ุฃุดุฌุงุฑ ุนุฒูุ ุงูุจูุงูุงุช ุงูุดุงุฐุฉ ุชุญุชุงุฌ ุฎุทูุงุช ุฃูู ููุนุฒู
- **ุฏุฑุฌุฉ ุงูุดุฐูุฐ**: `decision_function` ูุนุทู ุฏุฑุฌุฉ (-0.5 = ุนุงุฏูุ -1.0 = ุดุงุฐ ุฌุฏุงู)
- **ูุซุงู**: `iso_score = -0.8` โ `iso_risk = int(0.8 * 80) = 64` โ ูุญุฏูุฏ ุจู 25 = **25 ููุทุฉ**

**ููุงุฐุง IsolationForestุ**
- **ููุชุดู ุฃููุงุท ุฌุฏูุฏุฉ**: ูุง ูุญุชุงุฌ ุจูุงูุงุช ุชุฏุฑูุจ "risky"
- **ูููู**: ููุชุดู ูุง ูุฏ ุชููุชู ุงูููุงุฐุฌ ุงูุฅุดุฑุงููุฉ

---

##### **ุฌ) MLP Neural Network (ุดุจูุฉ ุนุตุจูุฉ)**

```python
# ุงููููุฐุฌ ุชุฏุฑูุจ ุนูู 3,200 ุนููุฉ (ูุน labels)
# ุฏูุฉ: 96.25%
# ุจููุฉ: 32 โ 16 โ 8 ุฎูุงูุง ุนุตุจูุฉ

# ุชุทุจูุน ุงูุจูุงูุงุช ุฃููุงู (ููู ููุดุจูุงุช ุงูุนุตุจูุฉ)
x_scaled = scaler.transform(x)  # StandardScaler

nn_pred_proba = nn_model.predict_proba(x_scaled)[0][1]  # ุงุญุชูุงู (0-1)
nn_risk = int(nn_pred_proba * 25)  # 0-25 ููุทุฉ
```

**ููู ุชุนูู ุงูุดุจูุฉ ุงูุนุตุจูุฉุ**
- **ุทุจูุงุช ูุชุนุฏุฏุฉ**: 3 ุทุจูุงุช ูุฎููุฉ (32 โ 16 โ 8)
- **ุชุนูู ุบูุฑ ุฎุทู**: ูููููุง ุงูุชุดุงู ุนูุงูุงุช ูุนูุฏุฉ
- **ุชุทุจูุน**: `StandardScaler` ูุญูู ุงูุจูุงูุงุช ุฅูู ูููุงุณ ููุญุฏ (ููู ุฌุฏุงู)

**ููุงุฐุง ุชุทุจูุน ุงูุจูุงูุงุชุ**
- ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุญุณุงุณุฉ ููููุงุณ ุงูุจูุงูุงุช
- ุจุฏูู ุชุทุจูุน: `location_change_km` (0-2000) ููููู ุนูู `device_is_known` (0-1)
- ูุน ุชุทุจูุน: ูู ุฎุงุตูุฉ ููุง ููุณ ุงููุฒู

---

#### **ุงูุฎุทูุฉ 3: ุชุฌููุน ุงููุชุงุฆุฌ**

```python
# ุฌูุน ุงูููุงุท ูู ุงูููุงุฐุฌ ุงูุซูุงุซุฉ
total_ai_risk = min(rf_risk + iso_risk + nn_risk, 40)

# ูุซุงู:
# rf_risk = 23
# iso_risk = 25
# nn_risk = 25
# total = 23 + 25 + 25 = 73 โ ูุญุฏูุฏ ุจู 40 = 40 ููุทุฉ โ
```

**ููุงุฐุง ุงูุณูู 40ุ**
- ููุน ููููุฉ ุทุจูุฉ AI ุนูู ุงููุชูุฌุฉ ุงููููุฉ
- ูุน 4 ุทุจูุงุชุ ูู ุทุจูุฉ ุชุณุงูู ุจูุณุจุฉ ูุนูููุฉ

---

#### **ุงูุฎุทูุฉ 4: Behavioral Boost (ุชุนุฒูุฒ ุณูููู)**

```python
# ุฅุฐุง ููู ุฅุดุงุฑุงุช ุณููููุฉ ูููุฉ ููู AI risk ููุฎูุถ
behavioral_red_flags = sum([
    not req.get("device_is_known", True),      # ุฌูุงุฒ ุฌุฏูุฏ
    req.get("location_change_km", 0) > 500,    # ููุฒุฉ ูููุน
    req.get("hour_of_day", 12) in [2, 3, 4, 5], # ููุช ุบูุฑ ูุนุชุงุฏ
    req.get("ops_last_24h", 0) > 8,            # ุถุบุท ุนูููุงุช
    req.get("is_sensitive_service", False)     # ุฎุฏูุฉ ุญุณุงุณุฉ
])

if behavioral_red_flags >= 3 and total_ai_risk < 20:
    boost = min(10, 20 - total_ai_risk)
    total_ai_risk += boost
```

**ููุงุฐุง Behavioral Boostุ**
- **ูุดููุฉ**: ุฃุญูุงูุงู ุงูููุงุฐุฌ ุชุนุทู ููุงุท ููุฎูุถุฉ ุฑุบู ูุฌูุฏ ุฅุดุงุฑุงุช ุณููููุฉ ูููุฉ
- **ุญู**: ุฅุฐุง 3+ ุฅุดุงุฑุงุช ุณููููุฉ + AI risk < 20 โ ูุถูู 5-10 ููุงุท
- **ูุซุงู**: 
  - AI risk = 8 ููุงุท
  - behavioral_red_flags = 4
  - boost = min(10, 20 - 8) = 10
  - **AI risk ุงูููุงุฆู = 8 + 10 = 18 ููุทุฉ** โ

---

#### **ุงูุฎุทูุฉ 5: ุงูุญุฏ ุงูุฃุฏูู**

```python
if total_ai_risk < 3:
    return 0, []  # ุฃูู ูู 3 = noiseุ ูุง ูุถูู ุดู
```

**ููุงุฐุง ุงูุญุฏ ุงูุฃุฏูู 3ุ**
- ููุน ุฅุถุงูุฉ ููุงุท ุถุฆููุฉ (noise)
- ุฅุฐุง AI risk < 3ุ ูุนุชุจุฑู 0 (ูุง ูุณุงููุฉ)

---

## **2.3 ูุซุงู ุนููู**

### **ุณููุงุฑูู:**
- ุฌูุงุฒ ุฌุฏูุฏ: โ
- ููุฒุฉ ูููุน: 800 ูู โ
- ููุช: 3 ุตุจุงุญุงู โ
- ุถุบุท ุนูููุงุช: 12 โ
- ุฎุฏูุฉ ุญุณุงุณุฉ: โ
- Session: ["login", "renew_id", "upload_doc"]

### **ุงูุญุณุงุจ:**

#### **1. Feature Extraction:**
```python
x = [0, 800.0, 3.0, 12.0, 1, 3.0, 1.0, 0.0]
```

#### **2. RandomForest:**
```python
proba_risky = 0.95
rf_risk = int(0.95 * 25) = 23 ููุทุฉ โ
```

#### **3. IsolationForest:**
```python
iso_pred = -1  # anomaly
iso_score = -0.8
iso_risk = int(0.8 * 80) = 64 โ ูุญุฏูุฏ ุจู 25 = 25 ููุทุฉ โ
```

#### **4. Neural Network:**
```python
x_scaled = scaler.transform(x)  # ุชุทุจูุน
nn_pred_proba = 1.0  # 100% risky
nn_risk = int(1.0 * 25) = 25 ููุทุฉ โ
```

#### **5. ุงูุชุฌููุน:**
```python
total_ai_risk = min(23 + 25 + 25, 40) = 40 ููุทุฉ โ
```

#### **6. Behavioral Boost:**
```python
behavioral_red_flags = 5  # ูู ุงูุฅุดุงุฑุงุช ููุฌูุฏุฉ
# ููู total_ai_risk = 40 (ุนุงูู)ุ ูุง ูุญุชุงุฌ boost โ
```

**ุงููุชูุฌุฉ ุงูููุงุฆูุฉ: 40 ููุทุฉ** โ

---

## **2.4 ููุงุท ุงูููุฉ**

โ **3 ููุงุฐุฌ ููููุฉ**: ูู ูููุฐุฌ ูู ููุงุท ููุฉ ูุฎุชููุฉ
โ **ุฏูุฉ ุนุงููุฉ**: RandomForest 98.88%ุ Neural Network 96.25%
โ **ููุชุดู ุฃููุงุท ูุนูุฏุฉ**: ML ููููู ุงูุชุดุงู ุนูุงูุงุช ุบูุฑ ูุงุถุญุฉ
โ **Behavioral Boost**: ูุถูู ูุณุงููุฉ AI ุญุชู ูู ุงูุญุงูุงุช ุงููุญุงูุธุฉ

---

# ๐ก **ุงูุทุจูุฉ 3: Sequence Risk (ุชุญููู ุชุณูุณู ุงูุฌูุณุฉ)**

## **3.1 ููุงุฐุง ูุฐู ุงูุทุจูุฉุ**

### **ุงูุณุจุจ ุงูุฃุณุงุณู:**
- **ุงูุชุดุงู ุฃููุงุท ูุฌูุงุช**: Brute-forceุ OTP abuseุ bot behavior
- **ุชุญููู ุงูุชุณูุณู**: ููุณ ููุท "ูุงุฐุง" ุจู "ููู" ู"ูุชู"
- **ุฎูููุฉ**: 0-30 ููุทุฉ (ูุง ุชูููู ุนูู ุงููุชูุฌุฉ)
- **ููููุฉ**: ุชูุชุดู ูุง ูุฏ ุชููุชู ุงูุทุจูุงุช ุงูุฃุฎุฑู

### **ูุง ุงูุฐู ุชูุชุดูู:**
- ุชูุฑุงุฑ login/payment (brute-force)
- ูุญุงููุงุช OTP ูุชูุฑุฑุฉ (OTP abuse)
- ุฎุฏูุงุช ุญุณุงุณุฉ ูุชุนุฏุฏุฉ ูู ุฌูุณุฉ ูุงุญุฏุฉ
- ูุตูู ุณุฑูุน ูุฎุฏูุฉ ุญุณุงุณุฉ (ุจุฏูู ุชุตูุญ)
- ุฌูุณุงุช ุทูููุฉ ุฌุฏุงู
- ูุณุงุฑ ุฎุทู ุจุฏูู ุงุณุชูุดุงู (bot-like)

---

## **3.2 ููู ุชุนูู ุงูุญุณุงุจุงุชุ**

### **ุงูุฎุทูุงุช:**

#### **1. ุชูุฑุงุฑ ุชุณุฌูู ุงูุฏุฎูู ุฃู ุงูุฏูุน (Repeated Actions)**

```python
if seq.count("login") >= 3 or seq.count("payment") >= 2:
    risk += 8
    reasons.append("repeated_actions")
```

**ุงูููุทู:**
- **3+ login**: ูุญุงููุงุช ูุชูุฑุฑุฉ = brute-force
- **2+ payment**: ูุญุงููุงุช ุฏูุน ูุชูุฑุฑุฉ = ูุฑูุจ

**ูุซุงู:**
```python
seq = ["login", "login", "login", "home"]
# count("login") = 3 โ risk += 8 โ
```

---

#### **2. ูุญุงููุงุช OTP ูุชูุฑุฑุฉ (OTP Abuse)**

```python
otp_count = seq.count("verify_otp")
if otp_count >= 3:
    risk += 6
    reasons.append("too_many_otp_challenges")
```

**ุงูููุทู:**
- **3+ OTP**: ูุญุงููุงุช ูุชูุฑุฑุฉ = brute-force ุฃู misuse
- **ุฃูู ูู 3**: ุทุจูุนู (ูุฏ ูููู ุฎุทุฃ ูู ุงูุฅุฏุฎุงู)

**ูุซุงู:**
```python
seq = ["login", "verify_otp", "verify_otp", "verify_otp", "home"]
# count("verify_otp") = 3 โ risk += 6 โ
```

---

#### **3. ุฎุฏูุงุช ุญุณุงุณุฉ ูุชุนุฏุฏุฉ (Multiple Sensitive Services)**

```python
sensitive_count = sum(1 for a in seq if is_sensitive_action(a))
if sensitive_count >= 2:
    risk += 8
    reasons.append("multiple_sensitive_services")
```

**ุงูููุทู:**
- **2+ ุฎุฏูุงุช ุญุณุงุณุฉ**: ูู ุฌูุณุฉ ูุงุญุฏุฉ = ูุฑูุจ
- **1 ุฎุฏูุฉ ุญุณุงุณุฉ**: ุทุจูุนู

**ูุซุงู:**
```python
seq = ["login", "renew_id", "vehicle_registration", "logout"]
# sensitive_count = 2 โ risk += 8 โ
```

---

#### **4. ูุตูู ุณุฑูุน ูุฎุฏูุฉ ุญุณุงุณุฉ (Sensitive Too Early)**

```python
if len(seq) > 1 and seq[0] == "login" and seq[1] in SENSITIVE_ACTIONS:
    risk += 10
    reasons.append("sensitive_too_early")
```

**ุงูููุทู:**
- **login โ ุฎุฏูุฉ ุญุณุงุณุฉ ูุจุงุดุฑุฉ**: ุจุฏูู ุฃู ุชุตูุญ = ูุฑูุจ
- **ุทุจูุนู**: login โ home โ services โ renew_id

**ูุซุงู:**
```python
seq = ["login", "renew_id", "upload_doc"]
# seq[0] = "login" โ
# seq[1] = "renew_id" (sensitive) โ
# risk += 10 โ
```

---

#### **5. ุฌูุณุฉ ุทูููุฉ ุฌุฏุงู (Long Session)**

```python
if len(seq) >= 7:
    risk += 4
    reasons.append("long_session_many_ops")
```

**ุงูููุทู:**
- **7+ ุฎุทูุงุช**: ุฌูุณุฉ ุทูููุฉ = ูุฏ ูููู ุญูุณุฉ
- **< 7 ุฎุทูุงุช**: ุทุจูุนู

---

#### **6. ูุณุงุฑ ุฎุทู ุจุฏูู ุงุณุชูุดุงู (Rare Navigation Pattern)**

```python
non_sensitive_steps = ["home", "view_personal_data", "services"]
has_exploration = any(a in non_sensitive_steps for a in seq)

if not has_exploration and len(seq) >= 5:
    risk += 7
    reasons.append("rare_navigation_pattern")
```

**ุงูููุทู:**
- **ูุณุงุฑ ุฎุทู**: login โ renew_id โ upload_doc โ logout (ุจุฏูู home/services)
- **ูุดุจู bot**: ูุง ูุณุชูุดู ุงููุงุฌูุฉุ ูุฐูุจ ูุจุงุดุฑุฉ ูููุฏู
- **ุทุจูุนู**: login โ home โ services โ renew_id (ูุณุชูุดู)

**ูุซุงู:**
```python
seq = ["login", "renew_id", "upload_doc", "payment", "logout"]
# len(seq) = 5 โ
# has_exploration = False (ูุง ููุฌุฏ "home" ุฃู "services") โ
# risk += 7 โ
```

---

#### **7. ุชุญุฏูุฏ ุงูุณูู**

```python
return min(risk, 30), reasons  # ุณูู 30 ููุทุฉ
```

**ููุงุฐุง ุงูุณูู 30ุ**
- ุทุจูุฉ ุฎูููุฉ (ููููุฉ)
- ูุง ุชูููู ุนูู ุงููุชูุฌุฉ ุงููููุฉ

---

## **3.3 ูุซุงู ุนููู**

### **ุณููุงุฑูู:**
```python
seq = ["login", "renew_id", "verify_otp", "verify_otp", "verify_otp", "upload_doc", "payment", "payment"]
```

### **ุงูุญุณุงุจ:**

#### **1. Repeated Actions:**
```python
count("login") = 1 โ (< 3)
count("payment") = 2 โ (>= 2)
risk += 8 โ
```

#### **2. OTP Abuse:**
```python
count("verify_otp") = 3 โ (>= 3)
risk += 6 โ
```

#### **3. Multiple Sensitive Services:**
```python
sensitive_count = 1 (renew_id ููุท) โ (< 2)
# ูุง ูุถูู ููุงุท
```

#### **4. Sensitive Too Early:**
```python
seq[0] = "login" โ
seq[1] = "renew_id" (sensitive) โ
risk += 10 โ
```

#### **5. Long Session:**
```python
len(seq) = 8 โ (>= 7)
risk += 4 โ
```

#### **6. Rare Navigation Pattern:**
```python
has_exploration = False (ูุง ููุฌุฏ "home" ุฃู "services") โ
len(seq) = 8 โ (>= 5)
risk += 7 โ
```

#### **7. ุงููุฌููุน:**
```python
total = 8 + 6 + 10 + 4 + 7 = 35
final = min(35, 30) = 30 ููุทุฉ โ
```

---

## **3.4 ููุงุท ุงูููุฉ**

โ **ุงูุชุดุงู ุฃููุงุท ูุฌูุงุช**: Brute-forceุ OTP abuseุ bot behavior
โ **ุชุญููู ุงูุชุณูุณู**: ููุณ ููุท "ูุงุฐุง" ุจู "ููู"
โ **ุฎูููุฉ**: 0-30 ููุทุฉ (ููููุฉ)
โ **ูุงุจูุฉ ููุชูุณูุฑ**: ูู ููุท ูู ุณุจุจ ูุงุถุญ

---

# ๐ด **ุงูุทุจูุฉ 4: Graph Risk (ุงูุฑุณู ุงูุดุจูู ูุงูุงุฑุชุจุงุทุงุช)**

## **4.1 ููุงุฐุง ูุฐู ุงูุทุจูุฉุ**

### **ุงูุณุจุจ ุงูุฃุณุงุณู:**
- **ุงูุชุดุงู ุดุจูุงุช ุงูุงุญุชูุงู**: IPsุ Devicesุ Docs ูุฑุชุจุทุฉ ุจุงุญุชูุงู ูุคูุฏ
- **ููุฉ ุฅุดุงุฑุฉ ุนุงููุฉ**: ูุนุชูุฏ ุนูู ุงุญุชูุงู ูุคูุฏ (ููุณ ุชููุน)
- **ุชูุงูู**: ูุฑุจุท ุจูู IPsุ Devicesุ Docs
- **ุชุดุงุจู ุงููุณุงุฑุงุช**: ููุชุดู ูุณุงุฑุงุช ูุดุงุจูุฉ ูุงุญุชูุงู ุณุงุจู

### **ูุง ุงูุฐู ุชูุชุดูู:**
- IP ุดุงุฑู ูู ูุนุงููุงุช ุงุญุชูุงู ูุคูุฏุฉ
- Device ูุฑุชุจุท ุจุงุญุชูุงู ูุคูุฏ
- Document Hash ูุณุชุฎุฏู ูู ุงุญุชูุงู ูุคูุฏ
- ูุณุงุฑ ุงูุฌูุณุฉ ูุดุจู ูุณุงุฑุงุช ุงุญุชูุงู ุณุงุจูุฉ

---

## **4.2 ููู ุชุนูู ุงูุญุณุงุจุงุชุ**

### **ุงูุฎุทูุงุช:**

#### **ุงูุฎุทูุฉ 1: ุชุณุฌูู ุญุงูุงุช ุงูุงุญุชูุงู ุงููุคูุฏุฉ**

ุนูุฏูุง ูุชู ุชุฃููุฏ ุญุงูุฉ ุงุญุชูุงู (ูู ุฎูุงู `/confirm-fraud`):

```python
def register_fraud_case(ip, device_id, doc_hash, session_sequence):
    # ูุญูุธ ุงูู assets ูุนูุงูุงุชูุง
    risky_assets["ip"][ip] = {
        "fraud_count": 1,  # ุนุฏุฏ ุญุงูุงุช ุงูุงุญุชูุงู
        "last_sequences": [session_sequence],  # ูุณุงุฑุงุช ุงูุงุญุชูุงู
        "related_devices": [device_id],  # ุงูุฃุฌูุฒุฉ ุงููุฑุชุจุทุฉ
        "related_docs": [doc_hash]  # ุงููุซุงุฆู ุงููุฑุชุจุทุฉ
    }
    # ููุณ ุงูุดูุก ููู device_id ู doc_hash
```

**ููุงุฐุง ูุญูุธ ุงูุนูุงูุงุชุ**
- ูุฑุจุท IPs ูุน Devices ู Docs
- ูุจูุงุก ุดุจูุฉ ุงุฑุชุจุงุทุงุช (graph)
- ูุงูุชุดุงู ุฃููุงุท ุงูุงุญุชูุงู

---

#### **ุงูุฎุทูุฉ 2: ุญุณุงุจ Graph Risk**

##### **ุฃ) IP Risk**

```python
ip_info = risky_assets["ip"].get(ip)
if ip_info and ip_info["fraud_count"] > 0:
    # ููุงุท ุญุณุจ ุนุฏุฏ ุญุงูุงุช ุงูุงุญุชูุงู
    add = min(12 * ip_info["fraud_count"], 35)
    total_risk += add
    
    # ูุซุงู:
    # fraud_count = 1 โ add = 12 ููุทุฉ
    # fraud_count = 2 โ add = 24 ููุทุฉ
    # fraud_count = 3 โ add = 35 ููุทุฉ (ูุญุฏูุฏ)
```

**ุงูููุทู:**
- **12 ููุทุฉ**: ููู ุญุงูุฉ ุงุญุชูุงู ูุคูุฏุฉ
- **ูุญุฏูุฏ ุจู 35**: ููุน ุงูุชุถุฎู

---

##### **ุจ) Sequence Similarity (ุชุดุงุจู ุงููุณุงุฑ)**

```python
# ููุงุฑูุฉ ุงููุณุงุฑ ุงูุญุงูู ูุน ูุณุงุฑุงุช ุงุญุชูุงู ุณุงุจูุฉ
best_sim = 0.0
for fraud_seq in ip_info["last_sequences"]:
    sim = sequence_similarity(current_seq, fraud_seq)
    best_sim = max(best_sim, sim)

if best_sim >= 0.6:  # 60% ุชุดุงุจู
    total_risk += 8
```

**ููู ูุนูู `sequence_similarity`ุ**
```python
def sequence_similarity(seq_a, seq_b):
    # ูุณุชุฎุฏู SequenceMatcher ูู difflib
    return SequenceMatcher(None, seq_a, seq_b).ratio()  # 0-1
```

**ูุซุงู:**
```python
current_seq = ["login", "renew_id", "upload_doc"]
fraud_seq = ["login", "renew_id", "upload_doc", "payment"]
similarity = 0.85  # 85% ุชุดุงุจู
# best_sim = 0.85 >= 0.6 โ risk += 8 โ
```

---

##### **ุฌ) Device Risk**

```python
dev_info = risky_assets["device_id"].get(device_id)
if dev_info and dev_info["fraud_count"] > 0:
    # Device ุฃูู ูู IP (18 ููุทุฉ ุจุฏูุงู ูู 12)
    add = min(18 * dev_info["fraud_count"], 40)
    total_risk += add
    
    # ููุณ ุงูุดูุก ูู sequence similarity
    if best_sim >= 0.6:
        total_risk += 8
```

**ููุงุฐุง Device ุฃูู ูู IPุ**
- **Device**: ุฌูุงุฒ ูุญุฏุฏ (ุฃุตุนุจ ูู ุงูุชุบููุฑ)
- **IP**: ูุฏ ูุชุบูุฑ (VPNุ proxy)

---

##### **ุฏ) Document Hash Risk**

```python
doc_info = risky_assets["doc_hash"].get(doc_hash)
if doc_info and doc_info["fraud_count"] > 0:
    # Document Hash: 12 ููุทุฉ (ูุซู IP)
    add = min(12 * doc_info["fraud_count"], 30)
    total_risk += add
    
    # ููุณ ุงูุดูุก ูู sequence similarity
    if best_sim >= 0.6:
        total_risk += 8
```

**ููุงุฐุง Document Hash ูููุ**
- **ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู**: ููุณ ุงููุซููุฉ ูู ุงุญุชูุงู ูุชุนุฏุฏ
- **ูุคุดุฑ ููู**: ูุซููุฉ ูุณุฑููุฉ ุฃู ูุฒูุฑุฉ

---

#### **ุงูุฎุทูุฉ 3: ุชุญุฏูุฏ ุงูุณูู**

```python
total_risk = min(total_risk, 50)  # ุณูู 50 ููุทุฉ
return total_risk, reason_codes, reason_details
```

**ููุงุฐุง ุงูุณูู 50ุ**
- Graph Risk ุฅุดุงุฑุฉ ูููุฉ ุฌุฏุงู (ูุนุชูุฏ ุนูู ุงุญุชูุงู ูุคูุฏ)
- ููู ูุง ูุฑูุฏ ุฃู ููููู ุนูู ุงููุชูุฌุฉ ุงููููุฉ

---

## **4.3 ูุซุงู ุนููู**

### **ุณููุงุฑูู:**
- IP: "IP_100" (ุดุงุฑู ูู 2 ุญุงูุงุช ุงุญุชูุงู)
- Device: "D1" (ุดุงุฑู ูู 1 ุญุงูุฉ ุงุญุชูุงู)
- Doc: "DOC_A" (ุดุงุฑู ูู 3 ุญุงูุงุช ุงุญุชูุงู)
- Current Sequence: ["login", "renew_id", "upload_doc"]
- Fraud Sequence (ูู IP_100): ["login", "renew_id", "upload_doc", "payment"]

### **ุงูุญุณุงุจ:**

#### **1. IP Risk:**
```python
ip_info = risky_assets["ip"]["IP_100"]
fraud_count = 2
add = min(12 * 2, 35) = 24 ููุทุฉ โ

# Sequence Similarity
similarity = 0.85 >= 0.6 โ risk += 8 โ
```

#### **2. Device Risk:**
```python
dev_info = risky_assets["device_id"]["D1"]
fraud_count = 1
add = min(18 * 1, 40) = 18 ููุทุฉ โ
```

#### **3. Doc Risk:**
```python
doc_info = risky_assets["doc_hash"]["DOC_A"]
fraud_count = 3
add = min(12 * 3, 30) = 30 ููุทุฉ โ
```

#### **4. ุงููุฌููุน:**
```python
total = 24 + 8 + 18 + 30 = 80
final = min(80, 50) = 50 ููุทุฉ โ
```

---

## **4.4 ููุงุท ุงูููุฉ**

โ **ุฅุดุงุฑุฉ ูููุฉ**: ูุนุชูุฏ ุนูู ุงุญุชูุงู ูุคูุฏ (ููุณ ุชููุน)
โ **ุงูุชุดุงู ุดุจูุงุช**: ูุฑุจุท ุจูู IPsุ Devicesุ Docs
โ **ุชุดุงุจู ุงููุณุงุฑุงุช**: ููุชุดู ูุณุงุฑุงุช ูุดุงุจูุฉ ูุงุญุชูุงู ุณุงุจู
โ **ุชูุงูู**: ูุฑุจุท ุจูู ุฌููุน ุงูู assets

---

# ๐ **ุงูุชุฌููุน ุงูููุงุฆู (Final Aggregation)**

## **ููู ูุชู ุชุฌููุน ุงููุชุงุฆุฌุ**

```python
# ูู ูู ุทุจูุฉ
behavior_risk = 50      # ูู ุงูุทุจูุฉ 1
ai_risk = 40            # ูู ุงูุทุจูุฉ 2
sequence_risk = 30       # ูู ุงูุทุจูุฉ 3
graph_risk = 50          # ูู ุงูุทุจูุฉ 4

# ุงููุฌููุน
total_risk = behavior_risk + ai_risk + sequence_risk + graph_risk
total_risk = min(total_risk, 100)  # ุณูู 100 ููุทุฉ

# ุงููุฑุงุฑ ุงูููุงุฆู
if total_risk <= 30:
    decision = "ALLOW"
elif total_risk <= 60:
    decision = "ALERT"
elif total_risk <= 80:
    decision = "CHALLENGE"
else:
    decision = "BLOCK_REVIEW"
```

---

## **ูุซุงู ูุงูู:**

### **ุงูุจูุงูุงุช:**
- ุฌูุงุฒ ุฌุฏูุฏ โ
- ููุฒุฉ ูููุน 800 ูู โ
- ููุช 3 ุตุจุงุญุงู โ
- ุถุบุท ุนูููุงุช 12 โ
- ุฎุฏูุฉ ุญุณุงุณุฉ โ
- IP ุดุงุฑู ูู 2 ุญุงูุงุช ุงุญุชูุงู โ
- Device ุดุงุฑู ูู 1 ุญุงูุฉ ุงุญุชูุงู โ

### **ุงููุชุงุฆุฌ:**

#### **1. Behavioral Risk:**
```
ุฌูุงุฒ ุฌุฏูุฏ (red_flags >= 3) = 20
ููุฒุฉ ูููุน (device_new + sensitive) = 20
ููุช ุบูุฑ ูุนุชุงุฏ (device_new) = 12
ุถุบุท ุนูููุงุช (12 < 15) = 8
ุฎุฏูุฉ ุญุณุงุณุฉ (red_flags >= 3) = 12
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงููุฌููุน = 72 โ ูุญุฏูุฏ ุจู 50 = 50 ููุทุฉ โ
```

#### **2. AI Risk:**
```
RandomForest (0.95) = 23
IsolationForest (anomaly) = 25
Neural Network (1.0) = 25
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงููุฌููุน = 73 โ ูุญุฏูุฏ ุจู 40 = 40 ููุทุฉ โ
```

#### **3. Sequence Risk:**
```
ูุณุงุฑ: ["login", "renew_id", "verify_otp", "verify_otp", "verify_otp"]
OTP abuse (3) = 6
Sensitive too early = 10
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงููุฌููุน = 16 ููุทุฉ โ
```

#### **4. Graph Risk:**
```
IP (2 fraud cases) = 24
Device (1 fraud case) = 18
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงููุฌููุน = 42 โ ูุญุฏูุฏ ุจู 50 = 42 ููุทุฉ โ
```

#### **5. ุงููุชูุฌุฉ ุงูููุงุฆูุฉ:**
```
Total = 50 + 40 + 16 + 42 = 148
Final = min(148, 100) = 100 ููุทุฉ โ
Decision = "BLOCK_REVIEW" โ
```

---

# ๐ฏ **ุงูุฎูุงุตุฉ**

## **ููุงุฐุง 4 ุทุจูุงุชุ**

1. **Behavioral Risk**: ุฃูู ุฎุท ุฏูุงุนุ ุณุฑูุนุ ูุงุจู ููุชูุณูุฑ
2. **AI/ML Risk**: ููุชุดู ุฃููุงุท ูุนูุฏุฉุ ุฏูุฉ ุนุงููุฉ
3. **Sequence Risk**: ููุชุดู ุฃููุงุท ูุฌูุงุชุ ูููู
4. **Graph Risk**: ุฅุดุงุฑุฉ ูููุฉ ุฌุฏุงู (ุงุญุชูุงู ูุคูุฏ)

## **ุงูุชูุงุฒู:**

- **ูู ุทุจูุฉ ููุง ุณูู**: ููุน ุงูููููุฉ
- **ูู ุทุจูุฉ ููููุฉ**: ุชูุชุดู ูุง ูุฏ ุชููุชู ุงูุฃุฎุฑู
- **ุงููุฌููุน ูุญุฏูุฏ**: 0-100 ููุทุฉ
- **ูุฑุงุฑุงุช ูุงุถุญุฉ**: ALLOW, ALERT, CHALLENGE, BLOCK_REVIEW

---

# ๐ **ูุฑุงุฌุน ุชูููุฉ**

## **ุงูููุงุฐุฌ ุงููุณุชุฎุฏูุฉ:**

1. **RandomForestClassifier**
   - `n_estimators=150`
   - `max_depth=8`
   - `class_weight="balanced"`
   - ุฏูุฉ: 98.88%

2. **IsolationForest**
   - `contamination=0.15`
   - ูุดู ุดุฐูุฐ ุบูุฑ ุฅุดุฑุงูู

3. **MLPClassifier**
   - `hidden_layer_sizes=(32, 16, 8)`
   - `activation='relu'`
   - `solver='adam'`
   - ุฏูุฉ: 96.25%

## **ุงูุฎุตุงุฆุต (Features):**

1. `device_is_known` (0/1)
2. `location_change_km` (0-2000)
3. `hour_of_day` (0-23)
4. `ops_last_24h` (0-20)
5. `is_sensitive_service` (0/1)
6. `session_length` (1-10)
7. `sensitive_count` (0-3)
8. `repeated_flag` (0/1)

---

**ุชู ุฅูุดุงุก ูุฐุง ุงููุณุชูุฏ ุจูุงุกู ุนูู ุงูููุฏ ุงููุนูู ูู `app.py` ู `train_model.py`** โ

